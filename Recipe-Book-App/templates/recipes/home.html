{% extends 'base.html' %}

{% block title %}Home - Recipe Book{% endblock %}

{% block content %}
<center>
    <h1>~~~ WELCOME TO THE RECIPE COLLECTION ~~~</h1>
    <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='20'%3E%3Ctext x='0' y='15' fill='%23FF1493' font-size='20'%3Eâ˜…â˜…â˜…â˜…â˜…%3C/text%3E%3C/svg%3E" alt="stars">
</center>

<hr>

<!-- Search and Filter -->
<table cellpadding="10" cellspacing="0" style="margin: 20px 0; background: #E0E0E0;">
    <tr>
        <td colspan="3" bgcolor="#000080" style="color: #FFF; font-weight: bold; text-align: center;">
            SEARCH & FILTER
        </td>
    </tr>
    <tr>
        <td colspan="3">
            <form method="get">
                <table width="100%" cellpadding="5">
                    <tr>
                        <td width="50%">
                            <label>Search Recipes:</label>
                            <input type="text" name="search" value="{{ search_query }}" placeholder="Type here...">
                        </td>
                        <td width="30%">
                            <label>Category:</label>
                            <select name="category">
                                <option value="">All Categories</option>
                                {% for category in categories %}
                                <option value="{{ category.id }}" {% if selected_category == category.id|stringformat:"s" %}selected{% endif %}>
                                    {{ category.name }}
                                </option>
                                {% endfor %}
                            </select>
                        </td>
                        <td width="20%" style="vertical-align: bottom;">
                            <button type="submit" class="btn">SEARCH!</button>
                        </td>
                    </tr>
                </table>
            </form>
        </td>
    </tr>
</table>

<p style="font-size: 18px; font-weight: bold; background: #FFFF00; padding: 10px; border: 3px solid #000;">
    >>> Found {{ recipes.count }} recipe{{ recipes.count|pluralize }} <<<
</p>

<!-- Recipes Grid -->
{% if recipes %}
<table width="100%" cellpadding="10" cellspacing="10">
    <tr>
        {% for recipe in recipes %}
        {% if forloop.counter0|divisibleby:3 and forloop.counter0 > 0 %}
    </tr>
    <tr>
        {% endif %}
        <td width="33%" valign="top">
            <table width="100%" cellpadding="10" style="background: linear-gradient(to bottom, #FFE4E1, #FFF0F5); border: 5px ridge #FF1493;">
                <tr>
                    <td bgcolor="#FF1493" style="color: #FFF; font-weight: bold; text-align: center; font-size: 18px;">
                        {{ recipe.title|upper }}
                    </td>
                </tr>
                <tr>
                    <td>
                        <p><b>Category:</b> <span style="color: #FF6347;">{{ recipe.category.name }}</span></p>
                        <p>{{ recipe.description|truncatewords:15 }}</p>
                        <hr style="border: 1px dashed #FF00FF;">
                        <p>
                            <span style="background: #00CED1; padding: 3px 8px; border: 2px solid #000; margin: 2px;">{{ recipe.get_difficulty_display }}</span>
                            <span style="background: #FFD700; padding: 3px 8px; border: 2px solid #000; margin: 2px;">{{ recipe.total_time }} min</span>
                            <span style="background: #00FF00; padding: 3px 8px; border: 2px solid #000; margin: 2px;">{{ recipe.servings }} servings</span>
                        </p>
                        <center>
                            <a href="{% url 'recipe_detail' recipe.pk %}" class="btn" style="margin-top: 10px;">VIEW RECIPE >></a>
                        </center>
                    </td>
                </tr>
            </table>
        </td>
        {% endfor %}
    </tr>
</table>
{% else %}
<center>
    <table width="60%" cellpadding="20" style="background: #FFE4B5; border: 5px double #FF0000; margin: 30px auto;">
        <tr>
            <td style="text-align: center;">
                <h2>NO RECIPES FOUND!</h2>
                <p style="font-size: 18px;">The recipe database is empty!</p>
                <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60'%3E%3Ctext x='0' y='50' font-size='50'%3EðŸ˜¢%3C/text%3E%3C/svg%3E" alt="sad">
                <br><br>
                <a href="{% url 'recipe_create' %}" class="btn">ADD YOUR FIRST RECIPE!</a>
            </td>
        </tr>
    </table>
</center>
{% endif %}

<hr>
<center>
    <p style="font-size: 12px;">
        <blink>*** NEW! ***</blink> Click on any recipe to see the full details!
    </p>
</center>
{% endblock %}
